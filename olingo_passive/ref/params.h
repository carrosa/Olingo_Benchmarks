#ifndef PARAMS_H
#define PARAMS_H

#include <gmp.h>
#include "config.h"

#define SEEDBYTES 64 // 64 // 32
#define CRHBYTES 64
#define CRYPTO_BYTES 32
#define TRBYTES 64
#define RNDBYTES 32
#define D 13
#define SAMPLEBYTES 15

#ifndef THRESHOLD
#define THRESHOLD 127
#endif

#ifndef USERS
#define USERS 128
#endif

// #define N 256
// #define MONT_BITS 128
// #define q "562949953438721"

// #define Q "169754086842540358005352209309511681"
// #define QINV "-133978373632131801599285206084969574399"
// #define DIV "-25978460312424105965743875580309239"
// #define MONT "-74577198354954337356572233802708949"
// #define DIV_QINV "57740766783911453634293358172553945353"
// #define ROOT_OF_UNITY "75574343650629980472360693068435123"

#define N 256
#define MONT_BITS 128
#define q "81623040078337"

#define Q "23473657271235664258052971185590273"
#define QINV "-126531856404333312370048579602401480703"
#define DIV "10865284098946342347313917950651675"
#define MONT "8231117106274378638737125451614048"
#define DIV_QINV "127139789314720935966328383684237786395"
#define ROOT_OF_UNITY "9416912205753154547029031700200650"



extern mpz_t GMP_Q;
extern mpz_t GMP_q;
extern mpz_t GMP_QINV;
extern mpz_t GMP_DIV;
extern mpz_t GMP_MONT;
extern mpz_t GMP_DIV_QINV;
extern mpz_t GMP_ROOT_OF_UNITY;
extern mpz_t GMP_MONT_BITS;
extern const mp_bitcnt_t MPBITCNT_MONT_BITS;

void init_params(void);
void free_params(void);

#define K 8
#define L 8
#define KHAT 21
#define LHAT 21
#define M 21

#define KAPPA_Y 29
#define KAPPA_Y_STR "536870912"
#define KAPPA_W 32
#define KAPPA_W_STR "4294967296"
extern mpz_t GMP_KAPPA_Y;
extern mpz_t GMP_KAPPA_W;

#define TAIL_BOUND 4.8
#define TAIL_BOUND_2 1.34

#define SIGMA_BINARY sqrt(2/3)
#define SIGMA_SMALL (1 << 10)
#define SIGMA_LARGE (1 << 29)

#define CTILDEBYTES 32
#define TAU 60

#define ETA 2

// Benchmarking
#define BENCHMARK_ITERATION 1
#endif
